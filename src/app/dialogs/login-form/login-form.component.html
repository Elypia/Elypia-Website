<!--
  ~ Elypia Website - The company website for Elypia.
  ~ Copyright (C) 2019-2019  Elypia CIC
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<mat-tab-group>
  <mat-tab label="Login">
    <form class="login-form" #form="ngForm" (ngSubmit)="onSubmit()">
      <div class="fields">
        <mat-form-field>
          <mat-label i18n>Email</mat-label>
          <input matInput required email
                 [(ngModel)]="email" #emailModel="ngModel"
                 (blur)="checkEmailExists()"
                 name="email" type="email" placeholder="panda@elypia.org"
                 tabindex="1"/>
          <mat-hint *ngIf="formType === LoginFormType.REGISTER" i18n>You'll be asked to verify it post-registration!</mat-hint>
          <mat-error *ngIf="emailModel.invalid">
            <mat-error *ngIf="emailModel.errors['email']" i18n>
              Please enter a valid email address!
            </mat-error>
            <mat-error *ngIf="emailModel.errors['required']" i18n>
              Email is required!
            </mat-error>
          </mat-error>
        </mat-form-field>
      </div>

      <div ngModelGroup="pmg" #pmg="ngModelGroup" [elyEquals]="['password', 'verifyPassword']">
        <mat-form-field>
          <mat-label i18n>Password</mat-label>
          <input matNativeControl required minlength="8" maxlength="72"
                 [(ngModel)]="password" #pm="ngModel"
                 name="password" type="password" placeholder="anything but 'password'"
                 tabindex="2"/>
          <mat-hint *ngIf="formType === LoginFormType.REGISTER" i18n>
            Considered using a password manager?
          </mat-hint>
          <mat-error *ngIf="pm.invalid && (pm.errors['minlength'] || pm.errors['maxlength'])" i18n>
            Password must be between 8 and 72 characters!
          </mat-error>
          <mat-error *ngIf="pm.invalid && pm.errors['required']" i18n>
            Password is required!
          </mat-error>
        </mat-form-field>

        <mat-form-field *ngIf="formType === LoginFormType.REGISTER">
          <mat-label i18n>Verify Password</mat-label>
          <input matNativeControl [(ngModel)]="verifyPassword"
                 [errorStateMatcher]="matcher"
                 name="verifyPassword" type="password" placeholder="<-"
                 tabindex="4"/>
          <mat-error *ngIf="pm.valid && pmg.invalid && pmg.errors['equals']" i18n>
            Password must match!
          </mat-error>
        </mat-form-field>
      </div>

      <mat-checkbox name="rememberMe" [(ngModel)]="rememberMe" i18n>Remember me!</mat-checkbox>

      <ely-stateful-button [state]="submissionState">
        {{(formType === LoginFormType.REGISTER) ? 'Register' : 'Login'}}
      </ely-stateful-button>

      <div *ngIf="newEmail" i18n>
        It looks like you're new here so we brought up registration form instead for you!
      </div>
    </form>
  </mat-tab>
  <mat-tab label="Register">

  </mat-tab>
  <mat-tab label="Forgot Password?">

  </mat-tab>
</mat-tab-group>
